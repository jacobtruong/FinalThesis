# 3_Evaluation

This directory provides the evaluation pipeline and the unaggregated, per-run evaluation statistics for each model, as detailed in our paper **"Advancing Code Generation Large Language Models with Novel Fine-Tuning Techniques."** The primary metrics evaluated are functional correctness (measured by **pass@10**) and code maintainability (measured by the **average Maintainability Index, or Average MI**). All logic for computing these metrics can be found in this folder.

Please note that in order for the code to run correctly, you will need the following folders:

* `mbpp_test_with_signatures` (Obtained from `1_Global_Dataset_Generation`)
* `[MODEL]-dpo-250-epochs` (Obtained from `2_Fine_Tuning_Process`, after Stage 1 DPO)
* `[MODEL]-dpo-250-epochs-further-250-epochs` (Obtained from `2_Fine_Tuning_Process`, after Stage 2 DPO)

## Directory and Script Breakdown

The evaluation process is replicated for each of the four models studied. This folder contains a sub-directory for each model (e.g., `gemma3-4b/`, `qwen3-4b/`, etc.).

Within each model's sub-directory, you will find:

* **Jupyter Notebooks (1-6):** A sequence of six notebooks that run the full evaluation pipeline for each of the three model variants (baseline, Stage 1 `-dpo`, and Stage 2 `-dpo-further`). The process is paired: one notebook runs the evaluation (generating and testing code), and the next analyses the results (calculating MI scores and `pass@10`).
    * `1_[model]_baseline_evaluation.ipynb`: Runs the `pass@10` evaluation 5 times for the **baseline model**.
    * `2_[model]_baseline_result_analysis.ipynb`: Analyses the 5 runs from the baseline model, calculates MI scores for all passed solutions, and saves the results.
    * `3_[model]_dpo_250_evaluation.ipynb`: Runs the `pass@10` evaluation 5 times for the **Stage 1 (`-dpo`) model**.
    * `4_[model]_dpo_250_result_analysis.ipynb`: Analyses the 5 runs from the Stage 1 model and calculates metrics.
    * `5_[model]_dpo_250_dpo_further_evaluation.ipynb`: Runs the `pass@10` evaluation 5 times for the **Stage 2 (`-dpo-further`) model**.
    * `6_[model]_dpo_250_dpo_further_result_analysis.ipynb`: Analyses the 5 runs from the Stage 2 model and calculates the final metrics.
* **Raw Output Files (`.json`):** These files (e.g., `qwen3_4b_baseline_model_output_run_1.json`) store the raw code completions generated by the models during each evaluation run.
* **Analysed Data Files (`.parquet`):** These files (e.g., `qwen3_4b_baseline_model_output_analysis_run_1.parquet`) store the processed data after analysis, including the code, pass/fail status, and calculated Maintainability Index for each generated solution.

Statistics are collected then averaged over 5 independent runs for each model configuration to ensure robust results, minimising run-to-run variance.

---

# Evaluation Statistics

## Gemma-1B Models

### Gemma-1B (Baseline)
Unaggregated Statistics for the baseline Gemma-1B model:
- Run 1 - Pass@10: 44.40% (222/500)
- Run 1 - Average Maintainability Index across 222 passed outputs: 87.80
- Run 2 - Pass@10: 44.20% (221/500)
- Run 2 - Average Maintainability Index across 221 passed outputs: 87.98
- Run 3 - Pass@10: 44.80% (224/500)
- Run 3 - Average Maintainability Index across 224 passed outputs: 87.76
- Run 4 - Pass@10: 45.00% (225/500)
- Run 4 - Average Maintainability Index across 225 passed outputs: 87.94
- Run 5 - Pass@10: 43.60% (218/500)
- Run 5 - Average Maintainability Index across 218 passed outputs: 88.01

### Gemma-1B-dpo (Stage 1)

Unaggregated statistics for the Gemma-1B-dpo model after the initial Stage 1 DPO fine-tuning:
- Run 1 - Pass@10: 43.60% (218/500)
- Run 1 - Average Maintainability Index across 218 passed outputs: 88.71
- Run 2 - Pass@10: 45.00% (225/500)
- Run 2 - Average Maintainability Index across 225 passed outputs: 88.34
- Run 3 - Pass@10: 44.80% (224/500)
- Run 3 - Average Maintainability Index across 224 passed outputs: 88.64
- Run 4 - Pass@10: 43.80% (219/500)
- Run 4 - Average Maintainability Index across 219 passed outputs: 88.20
- Run 5 - Pass@10: 44.20% (221/500)
- Run 5 - Average Maintainability Index across 221 passed outputs: 88.48

### Gemma-1B-dpo-further (Stage 2)

Unaggregated statistics for the Gemma-1B-dpo-further model after the Stage 2 iterative DPO fine-tuning:
- Run 1 - Pass@10: 44.80% (224/500)
- Run 1 - Average Maintainability Index across 224 passed outputs: 88.88
- Run 2 - Pass@10: 44.80% (224/500)
- Run 2 - Average Maintainability Index across 224 passed outputs: 88.90
- Run 3 - Pass@10: 45.00% (225/500)
- Run 3 - Average Maintainability Index across 225 passed outputs: 88.89
- Run 4 - Pass@10: 45.00% (225/500)
- Run 4 - Average Maintainability Index across 225 passed outputs: 88.67
- Run 5 - Pass@10: 44.60% (223/500)
- Run 5 - Average Maintainability Index across 223 passed outputs: 88.63

## Gemma-4B Models

### Gemma-4B (Baseline)
Unaggregated Statistics for the baseline Gemma-4B model:
- Run 1 - Pass@10: 55.00% (275/500)
- Run 1 - Average Maintainability Index across 275 passed outputs: 90.05
- Run 2 - Pass@10: 55.40% (277/500)
- Run 2 - Average Maintainability Index across 277 passed outputs: 90.22
- Run 3 - Pass@10: 56.60% (283/500)
- Run 3 - Average Maintainability Index across 283 passed outputs: 90.33
- Run 4 - Pass@10: 56.40% (282/500)
- Run 4 - Average Maintainability Index across 282 passed outputs: 90.03
- Run 5 - Pass@10: 56.60% (283/500)
- Run 5 - Average Maintainability Index across 283 passed outputs: 90.06

### Gemma-4B-dpo (Stage 1)

Unaggregated statistics for the Gemma-4B-dpo model after the initial Stage 1 DPO fine-tuning:
- Run 1 - Pass@10: 55.80% (279/500)
- Run 1 - Average Maintainability Index across 279 passed outputs: 90.38
- Run 2 - Pass@10: 55.20% (276/500)
- Run 2 - Average Maintainability Index across 276 passed outputs: 90.45
- Run 3 - Pass@10: 55.20% (276/500)
- Run 3 - Average Maintainability Index across 276 passed outputs: 90.61
- Run 4 - Pass@10: 55.80% (279/500)
- Run 4 - Average Maintainability Index across 279 passed outputs: 90.48
- Run 5 - Pass@10: 55.20% (276/500)
- Run 5 - Average Maintainability Index across 276 passed outputs: 90.50

### Gemma-4B-dpo-further (Stage 2)

Unaggregated statistics for the Gemma-4B-dpo-further model after the Stage 2 iterative DPO fine-tuning:
- Run 1 - Pass@10: 56.40% (282/500)
- Run 1 - Average Maintainability Index across 282 passed outputs: 90.71
- Run 2 - Pass@10: 56.40% (282/500)
- Run 2 - Average Maintainability Index across 282 passed outputs: 90.61
- Run 3 - Pass@10: 57.00% (285/500)
- Run 3 - Average Maintainability Index across 285 passed outputs: 90.87
- Run 4 - Pass@10: 56.20% (281/500)
- Run 4 - Average Maintainability Index across 281 passed outputs: 90.83
- Run 5 - Pass@10: 56.60% (283/500)
- Run 5 - Average Maintainability Index across 283 passed outputs: 90.74

## Gemma-12B Models

### Gemma-12B (Baseline)
Unaggregated Statistics for the baseline Gemma-12B model:
- Run 1 - Pass@10: 60.40% (302/500)
- Run 1 - Average Maintainability Index across 302 passed outputs: 89.71
- Run 2 - Pass@10: 60.80% (304/500)
- Run 2 - Average Maintainability Index across 304 passed outputs: 89.66
- Run 3 - Pass@10: 60.80% (304/500)
- Run 3 - Average Maintainability Index across 304 passed outputs: 89.64
- Run 4 - Pass@10: 61.20% (306/500)
- Run 4 - Average Maintainability Index across 306 passed outputs: 89.73
- Run 5 - Pass@10: 60.60% (303/500)
- Run 5 - Average Maintainability Index across 303 passed outputs: 89.83

### Gemma-12B-dpo (Stage 1)

Unaggregated statistics for the Gemma-12B-dpo model after the initial Stage 1 DPO fine-tuning:
- Run 1 - Pass@10: 60.40% (302/500)
- Run 1 - Average Maintainability Index across 302 passed outputs: 90.05
- Run 2 - Pass@10: 60.80% (304/500)
- Run 2 - Average Maintainability Index across 304 passed outputs: 89.96
- Run 3 - Pass@10: 60.80% (304/500)
- Run 3 - Average Maintainability Index across 304 passed outputs: 90.12
- Run 4 - Pass@10: 61.40% (307/500)
- Run 4 - Average Maintainability Index across 307 passed outputs: 89.90
- Run 5 - Pass@10: 60.00% (300/500)
- Run 5 - Average Maintainability Index across 300 passed outputs: 90.02

### Gemma-12B-dpo-further (Stage 2)

Unaggregated statistics for the Gemma-12B-dpo-further model after the Stage 2 iterative DPO fine-tuning:
- Run 1 - Pass@10: 60.80% (304/500)
- Run 1 - Average Maintainability Index across 304 passed outputs: 90.16
- Run 2 - Pass@10: 60.60% (303/500)
- Run 2 - Average Maintainability Index across 303 passed outputs: 90.02
- Run 3 - Pass@10: 61.80% (309/500)
- Run 3 - Average Maintainability Index across 309 passed outputs: 90.05
- Run 4 - Pass@10: 61.40% (307/500)
- Run 4 - Average Maintainability Index across 307 passed outputs: 90.04
- Run 5 - Pass@10: 60.00% (300/500)
- Run 5 - Average Maintainability Index across 300 passed outputs: 90.26

## Qwen-4B Models

### Qwen-4B (Baseline)
Unaggregated Statistics for the baseline Qwen-4B model:
- Run 1 - Pass@10: 60.60% (303/500)
- Run 1 - Average Maintainability Index across 303 passed outputs: 83.11
- Run 2 - Pass@10: 60.60% (303/500)
- Run 2 - Average Maintainability Index across 303 passed outputs: 83.08
- Run 3 - Pass@10: 60.60% (303/500)
- Run 3 - Average Maintainability Index across 303 passed outputs: 83.09
- Run 4 - Pass@10: 60.80% (304/500)
- Run 4 - Average Maintainability Index across 304 passed outputs: 82.88
- Run 5 - Pass@10: 60.60% (303/500)
- Run 5 - Average Maintainability Index across 303 passed outputs: 82.97

### Qwen-4B-dpo (Stage 1)

Unaggregated statistics for the Qwen-4B-dpo model after the initial Stage 1 DPO fine-tuning:
- Run 1 - Pass@10: 60.80% (304/500)
- Run 1 - Average Maintainability Index across 304 passed outputs: 84.08
- Run 2 - Pass@10: 60.80% (304/500)
- Run 2 - Average Maintainability Index across 304 passed outputs: 84.22
- Run 3 - Pass@10: 60.40% (302/500)
- Run 3 - Average Maintainability Index across 302 passed outputs: 84.04
- Run 4 - Pass@10: 60.40% (302/500)
- Run 4 - Average Maintainability Index across 302 passed outputs: 84.01
- Run 5 - Pass@10: 60.60% (303/500)
- Run 5 - Average Maintainability Index across 303 passed outputs: 84.05

### Qwen-4B-dpo-further (Stage 2)

Unaggregated statistics for the Qwen-4B-dpo-further model after the Stage 2 iterative DPO fine-tuning:
- Run 1 - Pass@10: 60.60% (303/500)
- Run 1 - Average Maintainability Index across 303 passed outputs: 84.64
- Run 2 - Pass@10: 60.80% (304/500)
- Run 2 - Average Maintainability Index across 304 passed outputs: 84.90
- Run 3 - Pass@10: 60.60% (303/500)
- Run 3 - Average Maintainability Index across 303 passed outputs: 84.81
- Run 4 - Pass@10: 60.80% (304/500)
- Run 4 - Average Maintainability Index across 304 passed outputs: 84.71
- Run 5 - Pass@10: 60.60% (303/500)
- Run 5 - Average Maintainability Index across 303 passed outputs: 84.73
